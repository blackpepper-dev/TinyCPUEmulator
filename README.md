![Build](https://github.com/blackpepper-dev/TinyCPUEmulator/actions/workflows/cmake-multi-platform.yml/badge.svg)



# üìò Virtual 8-bit CPU ‚Äî –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, ISA –∏ –ú–æ–¥—É–ª–∏

**–ò–º—è –ø—Ä–æ–µ–∫—Ç–∞:** TinyCPUemulator  
**–í–µ—Ä—Å–∏—è:** EmuCPU v1.0  
**–§–∏–ª–æ—Å–æ—Ñ–∏—è:** –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è, —Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è –º–æ–¥–µ–ª—å 8-–±–∏—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞, –≤–¥–æ—Ö–Ω–æ–≤–ª—ë–Ω–Ω–∞—è Intel 8080/8086, —Å –≥–∏–±–∫–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤–æ–π –º–æ–¥–µ–ª—å—é, –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

---

## üß± –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ‚Äî –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç CPU —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ/—Å—Ç—Ä—É–∫—Ç—É—Ä–µ:

| üìÑ –§–∞–π–ª      | üß© –ú–æ–¥—É–ª—å             | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                             |
|-------------|----------------------|----------------------------------------|
| emu_cpu     | EmuCPU               | –†–µ–≥–∏—Å—Ç—Ä—ã, ALU, –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ              |
| emu_mem     | Memory               | –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å, CS/DS –¥–æ—Å—Ç—É–ø       |
| emu_decode  | InstructionDecoder   | –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π               |
| emu_loader  | InstructionLoader    | –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–∞–Ω–¥ –≤ –¥–µ–∫–æ–¥–µ—Ä              |
| emu_enums   | Opcodes, Registers   | –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã             |
| emu_main    | main()               | –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ —ç–º—É–ª—è—Ü–∏–∏               |
| emu_spec    | ‚Äî                    | –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è ISA –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã         |

---

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **–†–∞–∑—Ä—è–¥–Ω–æ—Å—Ç—å:** 8 –±–∏—Ç  
- **–ü–∞–º—è—Ç—å:** 1024 –±–∞–π—Ç–∞ (1 KB)  
  - CS (–ö–æ–¥): `0x000 ‚Äì 0x1FF`  
  - DS (–î–∞–Ω–Ω—ã–µ): `0x200 ‚Äì 0x3FF`  
- **–†–µ–≥–∏—Å—Ç—Ä—ã:** `A`, `B`, `C`, `D` ‚Äî –æ–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è  
- **–£–ø—Ä–∞–≤–ª—è—é—â–∏–µ:** `PC`, `SR`, `halted`  
- **–ú–æ–¥–µ–ª—å –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:** `fetch ‚Üí decode ‚Üí execute`

---

## üî¢ –†–µ–≥–∏—Å—Ç—Ä—ã

| –ò–º—è | –ö–æ–¥  | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ         |
|-----|------|--------------------|
| A   | 0x00 | –ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä        |
| B   | 0x01 | –û–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è  |
| C   | 0x02 | –û–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è  |
| D   | 0x03 | –û–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è  |

---

## üìú Instruction Set (ISA)

| Mnemonic | –ö–æ–¥   | –û–ø–µ—Ä–∞–Ω–¥—ã       | –û–ø–∏—Å–∞–Ω–∏–µ                                 |
|----------|-------|----------------|------------------------------------------|
| NOP      | 0x00  | ‚Äî              | –ù–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏                             |
| MVI      | 0x01  | REG, imm8      | –ó–∞–≥—Ä—É–∑–∏—Ç—å –ª–∏—Ç–µ—Ä–∞–ª –≤ —Ä–µ–≥–∏—Å—Ç—Ä              |
| MOV      | 0x02  | REG1, REG2     | –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ                      |
| ADI      | 0x03  | REG, imm8      | REG += –ª–∏—Ç–µ—Ä–∞–ª                           |
| ADD      | 0x04  | REG1, REG2     | REG1 += REG2                             |
| SUI      | 0x05  | REG, imm8      | REG -= –ª–∏—Ç–µ—Ä–∞–ª                           |
| SUP      | 0x06  | REG1, REG2     | REG1 -= REG2                             |
| MLI      | 0x07  | REG, imm8      | REG *= –ª–∏—Ç–µ—Ä–∞–ª                           |
| MUL      | 0x08  | REG1, REG2     | REG1 *= REG2                             |
| DVI      | 0x09  | REG, imm8      | REG /= –ª–∏—Ç–µ—Ä–∞–ª                           |
| DIV      | 0x0A  | REG1, REG2     | REG1 /= REG2                             |
| SAV      | 0x0B  | REG, offset    | –°–æ—Ö—Ä–∞–Ω–∏—Ç—å REG ‚Üí DS + offset              |
| OUT      | 0x0C  | offset         | –í—ã–≤–æ–¥ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ DS + offset            |
| CMPI     | 0x0D  | REG, imm8      | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞ —Å –ª–∏—Ç–µ—Ä–∞–ª–æ–º           |
| CMP      | 0x0E  | REG1, REG2     | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤                 |
| JMP      | 0x1A  | offset         | –ë–µ–∑—É—Å–ª–æ–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –∫ –∞–¥—Ä–µ—Å—É CS + offset |
| JZ       | 0x1B  | offset         | –ü–µ—Ä–µ—Ö–æ–¥, –µ—Å–ª–∏ —Ñ–ª–∞–≥ Zero —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω       |
| JNZ      | 0x1C  | offset         | –ü–µ—Ä–µ—Ö–æ–¥, –µ—Å–ª–∏ —Ñ–ª–∞–≥ Zero –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω    |
| JC       | 0x1D  | offset         | –ü–µ—Ä–µ—Ö–æ–¥, –µ—Å–ª–∏ —Ñ–ª–∞–≥ Carry —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω      |
| JNC      | 0x1E  | offset         | –ü–µ—Ä–µ—Ö–æ–¥, –µ—Å–ª–∏ —Ñ–ª–∞–≥ Carry –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω   |
| HLT      | 0xFF  | ‚Äî              | –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è                     |

---

## üß™ –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã

```asm
MVI A, 10  
MVI B, 10  
CMP A, B      ; ‚Üí SR.Zero = 1  
JZ 0x20       ; ‚Üí –ø–µ—Ä–µ—Ö–æ–¥, –µ—Å–ª–∏ —Ä–∞–≤–Ω—ã  
MVI C, 1  
OUT 1  
HLT  
```

---

## üß† –§–ª–∞–≥ SR

| –§–ª–∞–≥     | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                      |
|----------|--------------------------------------------------|
| Zero     | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è = 0    |
| Carry    | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –±—ã–ª–æ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ (A < B) |
| Sign     | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç < 0 (–±–∏—Ç 7 = 1)  |
| Overflow | –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω –¥–ª—è –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∏                    |

- –§–ª–∞–≥–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ `CMP`, `CMPI`, –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π  
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —É—Å–ª–æ–≤–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤: `JZ`, `JNZ`, `JC`, `JNC`

---

## üöÄ –î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏ –∏ –∏–¥–µ–∏ —Ä–∞–∑–≤–∏—Ç–∏—è

### üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

- –£—Å–ª–æ–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã: `JZ`, `JNZ`, `JC`, `JNC`  
- –§–ª–∞–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞: SR ‚Üí Zero, Carry, Sign, Overflow  
- CALL/RET –∏ —Å—Ç–µ–∫–æ–≤–∞—è –º–æ–¥–µ–ª—å –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º  
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –∏ —Å–µ–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: Text/Data/Stack/I/O  
- –ö–æ—Å–≤–µ–Ω–Ω–∞—è –∞–¥—Ä–µ—Å–∞—Ü–∏—è: `LD r, [addr]`, `ST [addr], r`  
- –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –∏ —Å–æ–±—ã—Ç–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### ‚úçÔ∏è –Ø–∑—ã–∫–æ–≤—ã–µ –Ω–∞–¥—Å—Ç—Ä–æ–π–∫–∏

- –ê—Å—Å–µ–º–±–ª–µ—Ä `VCPU-Asm`: –º–µ—Ç–∫–∏, –º–∞–∫—Ä–æ—Å—ã, –±–∞–π—Ç–∫–æ–¥  
- DSL-—è–∑—ã–∫ `SomeLang`: –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, `if`, `while`  
- –ü—Å–µ–≤–¥–æ–∫–æ–º–ø–∏–ª—è—Ç–æ—Ä: —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è –∏–∑ C-like —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞

### üß™ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π

- –î–∏–∑–∞—Å—Å–µ–º–±–ª–µ—Ä: —á–∏—Ç–∞–µ–º—ã–π –≤—ã–≤–æ–¥ –∏–∑ –ø–∞–º—è—Ç–∏  
- –û—Ç–ª–∞–¥—á–∏–∫: —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞, –ø–æ—Ñ–∞–π–ª–æ–≤—ã–π –¥–∞–º–ø, —à–∞–≥–∏  
- –ó–∞–≥—Ä—É–∑—á–∏–∫: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ—à–∏–≤–æ–∫ –∏ –≤–Ω–µ—à–Ω–∏—Ö —Ñ–∞–π–ª–æ–≤

### üíª –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã

- `Hello, World!` —á–µ—Ä–µ–∑ OUT  
- –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä  
- –ü—Ä–æ—Å—Ç–∞—è REPL-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è  
- –ò–≥—Ä—ã/—Å—Ü–µ–Ω–∞—Ä–∏–∏ –Ω–∞ –±–∞–∑–µ CPU

### üî¨ –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã

- –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –û–°: –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏  
- –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –∏–∑ –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–≥–æ —è–∑—ã–∫–∞  
- Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —ç–º—É–ª—è—Ç–æ—Ä–∞ (JS/WebAssembly)  
- –°–∏–º—É–ª—è—Ü–∏—è –ø–µ—Ä–∏—Ñ–µ—Ä–∏–∏: —ç–∫—Ä–∞–Ω, –≤–≤–æ–¥, —Ç–∞–π–º–µ—Ä—ã

---

## üì¶ TODO: –¢–µ–∫—É—â–∞—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è

| –ú–æ–¥—É–ª—å               | –°—Ç–∞—Ç—É—Å        | –ó–∞–¥–∞—á–∏                                 |
|----------------------|---------------|----------------------------------------|
| emu_mem              | —á–∞—Å—Ç–∏—á–Ω–æ      | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞—â–∏—Ç—ã, reset, —Å–µ–≥–º–µ–Ω—Ç–æ–≤    |
| emu_alu              | –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è   | –û—Ç–¥–µ–ª–µ–Ω–∏–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∏                   |
| emu_flags            | –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è   | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SR                          |
| emu_instrmap         | –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è   | –¢–∞–±–ª–∏—Ü–∞ –∫–æ–º–∞–Ω–¥ –∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤            |
| emu_disasm           | –≤ –±—É–¥—É—â–µ–º     | –î–∏–∑–∞—Å—Å–µ–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ                     |
| emu_test             | –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è   | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤, –ø–∞–º—è—Ç–∏         |

---

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É, –≥–¥–µ –º–æ–∂–Ω–æ:

- –ü–∏—Å–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å –≤–µ—Ç–≤–ª–µ–Ω–∏—è–º–∏ –∏ —Ü–∏–∫–ª–∞–º–∏  
- –°–æ–∑–¥–∞—Ç—å –º–∏–∫—Ä–æ—è–∑—ã–∫ –Ω–∞–¥ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–æ–π  
- –¢—Ä–∞–Ω—Å–ª–∏—Ä–æ–≤–∞—Ç—å –≤ VCPU-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏  
- –£—á–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É CPU —á–µ—Ä–µ–∑ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–¥  
- –ü–æ—Å—Ç—Ä–æ–∏—Ç—å —Å–≤–æ—é –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –û–°
